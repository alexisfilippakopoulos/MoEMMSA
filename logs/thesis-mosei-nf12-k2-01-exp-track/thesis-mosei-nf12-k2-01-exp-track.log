2026-01-18 19:39:14,932 - MMSA [INFO] - ======================================== Program Start ========================================
2026-01-18 19:39:14,995 - MMSA [INFO] - Running with args:
2026-01-18 19:39:14,995 - MMSA [INFO] - {'model_name': 'msalm', 'dataset_name': 'mosei', 'featurePath': '/leonardo_work/EUHPC_A04_051/alexfil/MSA-Datasets/CMU-MOSEI/Processed/unaligned_50.pkl', 'seq_lens': [50, 500, 375], 'feature_dims': [768, 74, 35], 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'Loss', 'missing_rate': [0.0, 0.0, 0.0], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'early_stop': 10, 'use_bert': False, 'use_bert_finetune': False, 'attn_mask': True, 'excludeZero': True, 'update_epochs': 8, 'use_augmentation': False, 'use_m3xup': False, 'hfPath': False, 'use_ulgm': False, 'update_labels_patience': 1, 'H': 3.0, 'del_model': True, 'max_token_len': 50, 'pad_token': '<|endoftext|>', 'lm': '/leonardo_work/EUHPC_A04_051/alexfil/gpt2-large', 'use_bf16': False, 'task_out': 1, 'use_clm': True, 'gamma': 1.0, 'l_bn': 1.0, 'l_av': 1.0, 'l_t': 1.0, 'warmup_epochs': 1, 'max_epochs': 20, 'beta_1': 0.9, 'beta_2': 0.95, 'use_lnorm': True, 'rescale': False, 'rescaler': 'sqrt', 'use_seqaug': True, 'n_bn_fusion': 12, 'modded_loss': True, 'embedding_attr_name': 'transformer.wte', 'decoder_layers_attr_name': 'transformer.h', 'mmgpt': {'type': 'gpt2', 'd_out': 64, 'combine': True, 'dropout': 0.1, 'mm_layer': [7, 14, 21, 28, 35], 'top_k': 2, 'layer_dropout': 0.0, 'dense': True, 'tie_ffn': True, 'n_embd': 1280, 'bias': True, 'kv_dim': 30, 'n_head': 16, 'd_mm': 1280, 'gating': 'sigmoid', 'init_gate': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'use_softperm': True, 'p_perm': 0.3, 'p_apply': 0.25, 'use_lora': False, 'lora': {'lora_alpha': 128, 'r': 64, 'lora_dropout': 0.05}}, 'av_enc': {'finetune': True, 'from_pretrained': True, 'path_to_pretrained': '/leonardo_work/EUHPC_A04_051/alexfil/DeepMLF-Reprod/checkpoints/bienc-mosei-1990/bienc-mosei-1990.pth', 'feature_dims': [768, 74, 35], 'd_enc': 30, 'n_embd': 30, 'n_head': 6, 'nlevels': 3, 'd_enc_out': 30, 'maxlen': 50, 'p_mask': 0.15, 'enc_attn_dropout': 0.1, 'enc_res_dropout': 0.1, 'enc_dropout': 0.1, 'use_softperm': True, 'p_perm': 0.2, 'mask_perm_ratio': 0.5, 'tf_fusion': False, 'use_bn': False, 'use_ln': False}, 'gpt': {'vocab_size': 50257, 'block_size': 1024, 'bias': True, 'n_embd': 1024, 'n_layer': 24, 'n_head': 16, 'dropout': 0.0}, 'batch_size': 32, 'grad_clip': 5.0, 'patience': 10, 'weight_decay_mmgpt': 0.1, 'weight_decay_av': 0.1, 'learning_rate_av': 0.0001, 'learning_rate_mmgpt': 0.0001, 'device': device(type='cuda', index=0), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': '', 'feature_A': '', 'feature_V': ''}
2026-01-18 19:39:14,995 - MMSA [INFO] - Seeds: [1994]
2026-01-18 19:39:14,996 - MMSA [INFO] - ------------------------------ Running with seed 1994 [1/1] ------------------------------
2026-01-18 19:51:20,058 - MMSA [INFO] - The model has 914780556 trainable parameters
2026-01-18 19:55:52,984 - MMSA [INFO] - TRAIN-(msalm) [1/1/1] >> loss: 0.8125  Has0_acc_2: 0.6172  Has0_F1_score: 0.6347  Non0_acc_2: 0.6408  Non0_F1_score: 0.6465  Mult_acc_5: 0.4098  Mult_acc_7: 0.4083  MAE: 0.8128  Corr: 0.3657  clm loss: 4.2386 total loss: 7.6163 bn loss: 0.8627 av loss: 0.8367 text loss: 0.8658
2026-01-18 19:56:01,904 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7654  Has0_F1_score: 0.7751  Non0_acc_2: 0.8060  Non0_F1_score: 0.8071  Mult_acc_5: 0.4746  Mult_acc_7: 0.4618  MAE: 0.6346  Corr: 0.6234  Loss: 0.6340 
2026-01-18 20:00:36,803 - MMSA [INFO] - TRAIN-(msalm) [1/2/1] >> loss: 0.6022  Has0_acc_2: 0.7758  Has0_F1_score: 0.7840  Non0_acc_2: 0.8214  Non0_F1_score: 0.8224  Mult_acc_5: 0.5116  Mult_acc_7: 0.4977  MAE: 0.6023  Corr: 0.7058  clm loss: 3.7599 total loss: 6.4775 bn loss: 0.6287 av loss: 0.8041 text loss: 0.6826
2026-01-18 20:00:45,456 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8049  Has0_F1_score: 0.8134  Non0_acc_2: 0.8554  Non0_F1_score: 0.8567  Mult_acc_5: 0.5478  Mult_acc_7: 0.5361  MAE: 0.5258  Corr: 0.7465  Loss: 0.5243 
2026-01-18 20:05:21,126 - MMSA [INFO] - TRAIN-(msalm) [1/3/1] >> loss: 0.5339  Has0_acc_2: 0.8146  Has0_F1_score: 0.8199  Non0_acc_2: 0.8584  Non0_F1_score: 0.8583  Mult_acc_5: 0.5584  Mult_acc_7: 0.5381  MAE: 0.5330  Corr: 0.7750  clm loss: 3.6083 total loss: 6.0635 bn loss: 0.5349 av loss: 0.7994 text loss: 0.587
2026-01-18 20:05:29,721 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8391  Has0_F1_score: 0.8428  Non0_acc_2: 0.8672  Non0_F1_score: 0.8664  Mult_acc_5: 0.5804  Mult_acc_7: 0.5655  MAE: 0.5007  Corr: 0.7684  Loss: 0.5010 
2026-01-18 20:10:05,206 - MMSA [INFO] - TRAIN-(msalm) [1/4/1] >> loss: 0.4985  Has0_acc_2: 0.8264  Has0_F1_score: 0.8312  Non0_acc_2: 0.8734  Non0_F1_score: 0.8731  Mult_acc_5: 0.5908  Mult_acc_7: 0.5685  MAE: 0.4982  Corr: 0.8034  clm loss: 3.5398 total loss: 5.8773 bn loss: 0.5007 av loss: 0.7958 text loss: 0.5426
2026-01-18 20:10:13,966 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8402  Has0_F1_score: 0.8442  Non0_acc_2: 0.8713  Non0_F1_score: 0.8708  Mult_acc_5: 0.5687  Mult_acc_7: 0.5548  MAE: 0.4912  Corr: 0.7772  Loss: 0.4903 
2026-01-18 20:14:50,497 - MMSA [INFO] - TRAIN-(msalm) [1/5/1] >> loss: 0.4681  Has0_acc_2: 0.8327  Has0_F1_score: 0.8376  Non0_acc_2: 0.8870  Non0_F1_score: 0.8869  Mult_acc_5: 0.6132  Mult_acc_7: 0.5891  MAE: 0.4684  Corr: 0.8273  clm loss: 3.481 total loss: 5.7087 bn loss: 0.4702 av loss: 0.7932 text loss: 0.4962
2026-01-18 20:14:59,104 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8418  Has0_F1_score: 0.8455  Non0_acc_2: 0.8727  Non0_F1_score: 0.8720  Mult_acc_5: 0.5794  Mult_acc_7: 0.5644  MAE: 0.4939  Corr: 0.7750  Loss: 0.4945 
2026-01-18 20:19:30,420 - MMSA [INFO] - TRAIN-(msalm) [2/6/1] >> loss: 0.4442  Has0_acc_2: 0.8423  Has0_F1_score: 0.8467  Non0_acc_2: 0.8962  Non0_F1_score: 0.8959  Mult_acc_5: 0.6321  Mult_acc_7: 0.6096  MAE: 0.4439  Corr: 0.8432  clm loss: 3.4418 total loss: 5.5935 bn loss: 0.4515 av loss: 0.7915 text loss: 0.4645
2026-01-18 20:19:39,132 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8188  Has0_F1_score: 0.8251  Non0_acc_2: 0.8561  Non0_F1_score: 0.8565  Mult_acc_5: 0.5756  Mult_acc_7: 0.5601  MAE: 0.4939  Corr: 0.7771  Loss: 0.4943 
2026-01-18 20:24:10,585 - MMSA [INFO] - TRAIN-(msalm) [3/7/1] >> loss: 0.4224  Has0_acc_2: 0.8433  Has0_F1_score: 0.8482  Non0_acc_2: 0.9045  Non0_F1_score: 0.9046  Mult_acc_5: 0.6523  Mult_acc_7: 0.6280  MAE: 0.4221  Corr: 0.8592  clm loss: 3.4112 total loss: 5.489 bn loss: 0.429 av loss: 0.7911 text loss: 0.4354
2026-01-18 20:24:19,308 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8322  Has0_F1_score: 0.8362  Non0_acc_2: 0.8637  Non0_F1_score: 0.8628  Mult_acc_5: 0.5708  Mult_acc_7: 0.5564  MAE: 0.5016  Corr: 0.7745  Loss: 0.5005 
2026-01-18 20:28:50,847 - MMSA [INFO] - TRAIN-(msalm) [4/8/1] >> loss: 0.3987  Has0_acc_2: 0.8535  Has0_F1_score: 0.8576  Non0_acc_2: 0.9108  Non0_F1_score: 0.9106  Mult_acc_5: 0.6703  Mult_acc_7: 0.6466  MAE: 0.3983  Corr: 0.8745  clm loss: 3.3727 total loss: 5.3688 bn loss: 0.4027 av loss: 0.7899 text loss: 0.4048
2026-01-18 20:28:59,605 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8461  Has0_F1_score: 0.8460  Non0_acc_2: 0.8581  Non0_F1_score: 0.8547  Mult_acc_5: 0.5665  Mult_acc_7: 0.5494  MAE: 0.5165  Corr: 0.7692  Loss: 0.5167 
2026-01-18 20:33:31,280 - MMSA [INFO] - TRAIN-(msalm) [5/9/1] >> loss: 0.3802  Has0_acc_2: 0.8553  Has0_F1_score: 0.8598  Non0_acc_2: 0.9209  Non0_F1_score: 0.9209  Mult_acc_5: 0.6910  Mult_acc_7: 0.6641  MAE: 0.3803  Corr: 0.8850  clm loss: 3.362 total loss: 5.3087 bn loss: 0.3906 av loss: 0.7895 text loss: 0.3865
2026-01-18 20:33:40,000 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8300  Has0_F1_score: 0.8352  Non0_acc_2: 0.8665  Non0_F1_score: 0.8664  Mult_acc_5: 0.5623  Mult_acc_7: 0.5441  MAE: 0.5070  Corr: 0.7702  Loss: 0.5065 
2026-01-18 20:38:11,669 - MMSA [INFO] - TRAIN-(msalm) [6/10/1] >> loss: 0.3629  Has0_acc_2: 0.8592  Has0_F1_score: 0.8635  Non0_acc_2: 0.9252  Non0_F1_score: 0.9251  Mult_acc_5: 0.7031  Mult_acc_7: 0.6785  MAE: 0.3626  Corr: 0.8950  clm loss: 3.3405 total loss: 5.2333 bn loss: 0.3741 av loss: 0.7878 text loss: 0.368
2026-01-18 20:38:20,504 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7793  Has0_F1_score: 0.7904  Non0_acc_2: 0.8449  Non0_F1_score: 0.8472  Mult_acc_5: 0.5730  Mult_acc_7: 0.5596  MAE: 0.5076  Corr: 0.7752  Loss: 0.5074 
2026-01-18 20:42:51,640 - MMSA [INFO] - TRAIN-(msalm) [7/11/1] >> loss: 0.3424  Has0_acc_2: 0.8604  Has0_F1_score: 0.8650  Non0_acc_2: 0.9355  Non0_F1_score: 0.9355  Mult_acc_5: 0.7202  Mult_acc_7: 0.6964  MAE: 0.3422  Corr: 0.9062  clm loss: 3.3112 total loss: 5.1476 bn loss: 0.3591 av loss: 0.7874 text loss: 0.3475
2026-01-18 20:43:00,299 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8252  Has0_F1_score: 0.8306  Non0_acc_2: 0.8609  Non0_F1_score: 0.8609  Mult_acc_5: 0.5724  Mult_acc_7: 0.5569  MAE: 0.5005  Corr: 0.7716  Loss: 0.5010 
2026-01-18 20:47:31,309 - MMSA [INFO] - TRAIN-(msalm) [8/12/1] >> loss: 0.3296  Has0_acc_2: 0.8657  Has0_F1_score: 0.8701  Non0_acc_2: 0.9417  Non0_F1_score: 0.9417  Mult_acc_5: 0.7306  Mult_acc_7: 0.7062  MAE: 0.3295  Corr: 0.9118  clm loss: 3.3028 total loss: 5.0958 bn loss: 0.3454 av loss: 0.7876 text loss: 0.3304
2026-01-18 20:47:40,026 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7894  Has0_F1_score: 0.7997  Non0_acc_2: 0.8428  Non0_F1_score: 0.8452  Mult_acc_5: 0.5665  Mult_acc_7: 0.5510  MAE: 0.5074  Corr: 0.7727  Loss: 0.5079 
2026-01-18 20:52:10,852 - MMSA [INFO] - TRAIN-(msalm) [9/13/1] >> loss: 0.3219  Has0_acc_2: 0.8659  Has0_F1_score: 0.8703  Non0_acc_2: 0.9420  Non0_F1_score: 0.9420  Mult_acc_5: 0.7378  Mult_acc_7: 0.7107  MAE: 0.3216  Corr: 0.9189  clm loss: 3.292 total loss: 5.0493 bn loss: 0.3324 av loss: 0.7871 text loss: 0.3159
2026-01-18 20:52:20,017 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8012  Has0_F1_score: 0.8098  Non0_acc_2: 0.8498  Non0_F1_score: 0.8512  Mult_acc_5: 0.5633  Mult_acc_7: 0.5494  MAE: 0.5036  Corr: 0.7709  Loss: 0.5046 
2026-01-18 20:56:50,885 - MMSA [INFO] - TRAIN-(msalm) [10/14/1] >> loss: 0.312  Has0_acc_2: 0.8693  Has0_F1_score: 0.8736  Non0_acc_2: 0.9481  Non0_F1_score: 0.9481  Mult_acc_5: 0.7486  Mult_acc_7: 0.7234  MAE: 0.3120  Corr: 0.9230  clm loss: 3.2736 total loss: 4.9968 bn loss: 0.3211 av loss: 0.7864 text loss: 0.3037
2026-01-18 20:56:59,520 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8113  Has0_F1_score: 0.8188  Non0_acc_2: 0.8574  Non0_F1_score: 0.8583  Mult_acc_5: 0.5708  Mult_acc_7: 0.5569  MAE: 0.5001  Corr: 0.7728  Loss: 0.5021 
2026-01-18 20:57:26,147 - MMSA [INFO] - TEST-(msalm) >>  Has0_acc_2: 0.8337  Has0_F1_score: 0.8378  Non0_acc_2: 0.8745  Non0_F1_score: 0.8742  Mult_acc_5: 0.5705  Mult_acc_7: 0.5518  MAE: 0.5052  Corr: 0.7998  Loss: 0.5058 
2026-01-18 20:57:28,311 - MMSA [INFO] - Result for seed 1994: {'Has0_acc_2': 0.8337, 'Has0_F1_score': 0.8378, 'Non0_acc_2': 0.8745, 'Non0_F1_score': 0.8742, 'Mult_acc_5': 0.5705, 'Mult_acc_7': 0.5518, 'MAE': 0.5052, 'Corr': 0.7998, 'Loss': 0.5058, 'seed': 1994}
2026-01-18 20:57:28,344 - MMSA [INFO] - Results saved to MMSA/results/mosei/nf12_k2_0001-exp-track/thesis-mosei-nf12-k2-01-exp-track/normal/mosei_avg.csv.
