2026-01-18 20:09:37,416 - MMSA [INFO] - ======================================== Program Start ========================================
2026-01-18 20:09:37,484 - MMSA [INFO] - Running with args:
2026-01-18 20:09:37,484 - MMSA [INFO] - {'model_name': 'msalm', 'dataset_name': 'mosei', 'featurePath': '/leonardo_work/EUHPC_A04_051/alexfil/MSA-Datasets/CMU-MOSEI/Processed/unaligned_50.pkl', 'seq_lens': [50, 500, 375], 'feature_dims': [768, 74, 35], 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'Loss', 'missing_rate': [0.0, 0.0, 0.0], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'early_stop': 10, 'use_bert': False, 'use_bert_finetune': False, 'attn_mask': True, 'excludeZero': True, 'update_epochs': 8, 'use_augmentation': False, 'use_m3xup': False, 'hfPath': False, 'use_ulgm': False, 'update_labels_patience': 1, 'H': 3.0, 'del_model': True, 'max_token_len': 50, 'pad_token': '<|endoftext|>', 'lm': '/leonardo_work/EUHPC_A04_051/alexfil/gpt2-large', 'use_bf16': False, 'task_out': 1, 'use_clm': True, 'gamma': 1.0, 'l_bn': 1.0, 'l_av': 1.0, 'l_t': 1.0, 'warmup_epochs': 1, 'max_epochs': 20, 'beta_1': 0.9, 'beta_2': 0.95, 'use_lnorm': True, 'rescale': False, 'rescaler': 'sqrt', 'use_seqaug': True, 'n_bn_fusion': 12, 'modded_loss': True, 'embedding_attr_name': 'transformer.wte', 'decoder_layers_attr_name': 'transformer.h', 'mmgpt': {'type': 'gpt2', 'd_out': 64, 'combine': True, 'dropout': 0.1, 'mm_layer': [7, 14, 21, 28, 35], 'top_k': 1, 'layer_dropout': 0.0, 'dense': True, 'tie_ffn': True, 'n_embd': 1280, 'bias': True, 'kv_dim': 30, 'n_head': 16, 'd_mm': 1280, 'gating': 'sigmoid', 'init_gate': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'use_softperm': True, 'p_perm': 0.3, 'p_apply': 0.25, 'use_lora': False, 'lora': {'lora_alpha': 128, 'r': 64, 'lora_dropout': 0.05}}, 'av_enc': {'finetune': True, 'from_pretrained': True, 'path_to_pretrained': '/leonardo_work/EUHPC_A04_051/alexfil/DeepMLF-Reprod/checkpoints/bienc-mosei-1990/bienc-mosei-1990.pth', 'feature_dims': [768, 74, 35], 'd_enc': 30, 'n_embd': 30, 'n_head': 6, 'nlevels': 3, 'd_enc_out': 30, 'maxlen': 50, 'p_mask': 0.15, 'enc_attn_dropout': 0.1, 'enc_res_dropout': 0.1, 'enc_dropout': 0.1, 'use_softperm': True, 'p_perm': 0.2, 'mask_perm_ratio': 0.5, 'tf_fusion': False, 'use_bn': False, 'use_ln': False}, 'gpt': {'vocab_size': 50257, 'block_size': 1024, 'bias': True, 'n_embd': 1024, 'n_layer': 24, 'n_head': 16, 'dropout': 0.0}, 'batch_size': 32, 'grad_clip': 5.0, 'patience': 10, 'weight_decay_mmgpt': 0.1, 'weight_decay_av': 0.1, 'learning_rate_av': 0.0001, 'learning_rate_mmgpt': 0.0001, 'device': device(type='cuda', index=0), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': '', 'feature_A': '', 'feature_V': ''}
2026-01-18 20:09:37,484 - MMSA [INFO] - Seeds: [1994]
2026-01-18 20:09:37,485 - MMSA [INFO] - ------------------------------ Running with seed 1994 [1/1] ------------------------------
2026-01-18 20:21:11,788 - MMSA [INFO] - The model has 914780556 trainable parameters
2026-01-18 20:25:38,440 - MMSA [INFO] - TRAIN-(msalm) [1/1/1] >> loss: 0.8132  Has0_acc_2: 0.6161  Has0_F1_score: 0.6336  Non0_acc_2: 0.6391  Non0_F1_score: 0.6449  Mult_acc_5: 0.4085  Mult_acc_7: 0.4068  MAE: 0.8135  Corr: 0.3645  clm loss: 4.247 total loss: 7.628 bn loss: 0.8648 av loss: 0.8367 text loss: 0.8664
2026-01-18 20:25:47,201 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7557  Has0_F1_score: 0.7669  Non0_acc_2: 0.7990  Non0_F1_score: 0.8012  Mult_acc_5: 0.4730  Mult_acc_7: 0.4613  MAE: 0.6336  Corr: 0.6220  Loss: 0.6329 
2026-01-18 20:30:16,693 - MMSA [INFO] - TRAIN-(msalm) [1/2/1] >> loss: 0.6042  Has0_acc_2: 0.7726  Has0_F1_score: 0.7809  Non0_acc_2: 0.8187  Non0_F1_score: 0.8198  Mult_acc_5: 0.5107  Mult_acc_7: 0.4966  MAE: 0.6044  Corr: 0.7033  clm loss: 3.7677 total loss: 6.4939 bn loss: 0.6337 av loss: 0.8041 text loss: 0.6842
2026-01-18 20:30:25,228 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8108  Has0_F1_score: 0.8188  Non0_acc_2: 0.8609  Non0_F1_score: 0.8620  Mult_acc_5: 0.5500  Mult_acc_7: 0.5382  MAE: 0.5276  Corr: 0.7454  Loss: 0.5260 
2026-01-18 20:34:55,193 - MMSA [INFO] - TRAIN-(msalm) [1/3/1] >> loss: 0.5358  Has0_acc_2: 0.8158  Has0_F1_score: 0.8210  Non0_acc_2: 0.8592  Non0_F1_score: 0.8591  Mult_acc_5: 0.5563  Mult_acc_7: 0.5368  MAE: 0.5349  Corr: 0.7732  clm loss: 3.611 total loss: 6.0725 bn loss: 0.5371 av loss: 0.7994 text loss: 0.5892
2026-01-18 20:35:03,575 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8413  Has0_F1_score: 0.8449  Non0_acc_2: 0.8713  Non0_F1_score: 0.8706  Mult_acc_5: 0.5826  Mult_acc_7: 0.5676  MAE: 0.5016  Corr: 0.7709  Loss: 0.5017 
2026-01-18 20:39:34,108 - MMSA [INFO] - TRAIN-(msalm) [1/4/1] >> loss: 0.4994  Has0_acc_2: 0.8262  Has0_F1_score: 0.8310  Non0_acc_2: 0.8742  Non0_F1_score: 0.8740  Mult_acc_5: 0.5911  Mult_acc_7: 0.5686  MAE: 0.4992  Corr: 0.8027  clm loss: 3.5409 total loss: 5.8812 bn loss: 0.5021 av loss: 0.7958 text loss: 0.543
2026-01-18 20:39:42,655 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8381  Has0_F1_score: 0.8421  Non0_acc_2: 0.8713  Non0_F1_score: 0.8706  Mult_acc_5: 0.5746  Mult_acc_7: 0.5601  MAE: 0.4906  Corr: 0.7767  Loss: 0.4896 
2026-01-18 20:44:12,535 - MMSA [INFO] - TRAIN-(msalm) [1/5/1] >> loss: 0.4699  Has0_acc_2: 0.8308  Has0_F1_score: 0.8359  Non0_acc_2: 0.8862  Non0_F1_score: 0.8861  Mult_acc_5: 0.6106  Mult_acc_7: 0.5872  MAE: 0.4702  Corr: 0.8255  clm loss: 3.4811 total loss: 5.713 bn loss: 0.4722 av loss: 0.7931 text loss: 0.4967
2026-01-18 20:44:21,034 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8455  Has0_F1_score: 0.8488  Non0_acc_2: 0.8700  Non0_F1_score: 0.8692  Mult_acc_5: 0.5831  Mult_acc_7: 0.5687  MAE: 0.4900  Corr: 0.7776  Loss: 0.4904 
2026-01-18 20:48:46,133 - MMSA [INFO] - TRAIN-(msalm) [2/6/1] >> loss: 0.4444  Has0_acc_2: 0.8436  Has0_F1_score: 0.8478  Non0_acc_2: 0.8964  Non0_F1_score: 0.8961  Mult_acc_5: 0.6318  Mult_acc_7: 0.6086  MAE: 0.4442  Corr: 0.8428  clm loss: 3.4427 total loss: 5.5958 bn loss: 0.4524 av loss: 0.7915 text loss: 0.4648
2026-01-18 20:48:54,595 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8236  Has0_F1_score: 0.8293  Non0_acc_2: 0.8602  Non0_F1_score: 0.8603  Mult_acc_5: 0.5746  Mult_acc_7: 0.5601  MAE: 0.4937  Corr: 0.7754  Loss: 0.4941 
2026-01-18 20:53:19,618 - MMSA [INFO] - TRAIN-(msalm) [3/7/1] >> loss: 0.4228  Has0_acc_2: 0.8422  Has0_F1_score: 0.8471  Non0_acc_2: 0.9030  Non0_F1_score: 0.9030  Mult_acc_5: 0.6506  Mult_acc_7: 0.6267  MAE: 0.4226  Corr: 0.8588  clm loss: 3.412 total loss: 5.4919 bn loss: 0.4299 av loss: 0.791 text loss: 0.4362
2026-01-18 20:53:28,196 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8434  Has0_F1_score: 0.8467  Non0_acc_2: 0.8713  Non0_F1_score: 0.8704  Mult_acc_5: 0.5714  Mult_acc_7: 0.5569  MAE: 0.5027  Corr: 0.7729  Loss: 0.5015 
2026-01-18 20:57:53,343 - MMSA [INFO] - TRAIN-(msalm) [4/8/1] >> loss: 0.3985  Has0_acc_2: 0.8541  Has0_F1_score: 0.8581  Non0_acc_2: 0.9109  Non0_F1_score: 0.9107  Mult_acc_5: 0.6686  Mult_acc_7: 0.6451  MAE: 0.3981  Corr: 0.8745  clm loss: 3.3727 total loss: 5.369 bn loss: 0.4037 av loss: 0.79 text loss: 0.4041
2026-01-18 20:58:01,874 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8423  Has0_F1_score: 0.8428  Non0_acc_2: 0.8554  Non0_F1_score: 0.8522  Mult_acc_5: 0.5665  Mult_acc_7: 0.5489  MAE: 0.5153  Corr: 0.7697  Loss: 0.5156 
2026-01-18 21:02:26,614 - MMSA [INFO] - TRAIN-(msalm) [5/9/1] >> loss: 0.38  Has0_acc_2: 0.8550  Has0_F1_score: 0.8594  Non0_acc_2: 0.9202  Non0_F1_score: 0.9202  Mult_acc_5: 0.6891  Mult_acc_7: 0.6628  MAE: 0.3801  Corr: 0.8848  clm loss: 3.3619 total loss: 5.3106 bn loss: 0.392 av loss: 0.7895 text loss: 0.3871
2026-01-18 21:02:35,047 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8332  Has0_F1_score: 0.8379  Non0_acc_2: 0.8686  Non0_F1_score: 0.8682  Mult_acc_5: 0.5714  Mult_acc_7: 0.5553  MAE: 0.5075  Corr: 0.7697  Loss: 0.5072 
2026-01-18 21:06:59,868 - MMSA [INFO] - TRAIN-(msalm) [6/10/1] >> loss: 0.3629  Has0_acc_2: 0.8583  Has0_F1_score: 0.8627  Non0_acc_2: 0.9260  Non0_F1_score: 0.9259  Mult_acc_5: 0.7019  Mult_acc_7: 0.6776  MAE: 0.3625  Corr: 0.8953  clm loss: 3.3407 total loss: 5.2318 bn loss: 0.3744 av loss: 0.7878 text loss: 0.366
2026-01-18 21:07:08,374 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7771  Has0_F1_score: 0.7885  Non0_acc_2: 0.8449  Non0_F1_score: 0.8472  Mult_acc_5: 0.5772  Mult_acc_7: 0.5633  MAE: 0.5069  Corr: 0.7749  Loss: 0.5066 
2026-01-18 21:11:33,780 - MMSA [INFO] - TRAIN-(msalm) [7/11/1] >> loss: 0.3421  Has0_acc_2: 0.8617  Has0_F1_score: 0.8662  Non0_acc_2: 0.9355  Non0_F1_score: 0.9355  Mult_acc_5: 0.7170  Mult_acc_7: 0.6935  MAE: 0.3420  Corr: 0.9060  clm loss: 3.3108 total loss: 5.1452 bn loss: 0.3584 av loss: 0.7873 text loss: 0.3466
2026-01-18 21:11:42,290 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8322  Has0_F1_score: 0.8372  Non0_acc_2: 0.8693  Non0_F1_score: 0.8691  Mult_acc_5: 0.5788  Mult_acc_7: 0.5628  MAE: 0.4986  Corr: 0.7716  Loss: 0.4989 
2026-01-18 21:16:07,108 - MMSA [INFO] - TRAIN-(msalm) [8/12/1] >> loss: 0.3292  Has0_acc_2: 0.8660  Has0_F1_score: 0.8704  Non0_acc_2: 0.9424  Non0_F1_score: 0.9424  Mult_acc_5: 0.7330  Mult_acc_7: 0.7084  MAE: 0.3290  Corr: 0.9119  clm loss: 3.3026 total loss: 5.0944 bn loss: 0.3448 av loss: 0.7875 text loss: 0.3304
2026-01-18 21:16:15,544 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7878  Has0_F1_score: 0.7984  Non0_acc_2: 0.8428  Non0_F1_score: 0.8453  Mult_acc_5: 0.5633  Mult_acc_7: 0.5484  MAE: 0.5098  Corr: 0.7703  Loss: 0.5102 
2026-01-18 21:20:40,301 - MMSA [INFO] - TRAIN-(msalm) [9/13/1] >> loss: 0.3222  Has0_acc_2: 0.8664  Has0_F1_score: 0.8707  Non0_acc_2: 0.9413  Non0_F1_score: 0.9412  Mult_acc_5: 0.7368  Mult_acc_7: 0.7097  MAE: 0.3220  Corr: 0.9188  clm loss: 3.292 total loss: 5.0502 bn loss: 0.333 av loss: 0.7871 text loss: 0.3159
2026-01-18 21:20:48,610 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8028  Has0_F1_score: 0.8114  Non0_acc_2: 0.8554  Non0_F1_score: 0.8567  Mult_acc_5: 0.5665  Mult_acc_7: 0.5532  MAE: 0.5021  Corr: 0.7706  Loss: 0.5032 
2026-01-18 21:25:13,491 - MMSA [INFO] - TRAIN-(msalm) [10/14/1] >> loss: 0.3125  Has0_acc_2: 0.8683  Has0_F1_score: 0.8726  Non0_acc_2: 0.9468  Non0_F1_score: 0.9468  Mult_acc_5: 0.7482  Mult_acc_7: 0.7238  MAE: 0.3126  Corr: 0.9227  clm loss: 3.2733 total loss: 4.9979 bn loss: 0.322 av loss: 0.7864 text loss: 0.3038
2026-01-18 21:25:21,921 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8172  Has0_F1_score: 0.8243  Non0_acc_2: 0.8651  Non0_F1_score: 0.8658  Mult_acc_5: 0.5772  Mult_acc_7: 0.5628  MAE: 0.5014  Corr: 0.7723  Loss: 0.5036 
2026-01-18 21:25:44,614 - MMSA [INFO] - TEST-(msalm) >>  Has0_acc_2: 0.8347  Has0_F1_score: 0.8388  Non0_acc_2: 0.8729  Non0_F1_score: 0.8725  Mult_acc_5: 0.5709  Mult_acc_7: 0.5523  MAE: 0.5053  Corr: 0.7998  Loss: 0.5058 
2026-01-18 21:25:46,733 - MMSA [INFO] - Result for seed 1994: {'Has0_acc_2': 0.8347, 'Has0_F1_score': 0.8388, 'Non0_acc_2': 0.8729, 'Non0_F1_score': 0.8725, 'Mult_acc_5': 0.5709, 'Mult_acc_7': 0.5523, 'MAE': 0.5053, 'Corr': 0.7998, 'Loss': 0.5058, 'seed': 1994}
2026-01-18 21:25:46,758 - MMSA [INFO] - Results saved to MMSA/results/mosei/nf12_k1_0001-exp-track/thesis-mosei-nf12-k1-01-exp-track/normal/mosei_avg.csv.
