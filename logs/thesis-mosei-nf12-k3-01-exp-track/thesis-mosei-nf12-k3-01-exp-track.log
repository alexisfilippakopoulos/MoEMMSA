2026-01-18 15:52:38,591 - MMSA [INFO] - ======================================== Program Start ========================================
2026-01-18 15:52:38,650 - MMSA [INFO] - Running with args:
2026-01-18 15:52:38,651 - MMSA [INFO] - {'model_name': 'msalm', 'dataset_name': 'mosei', 'featurePath': '/leonardo_work/EUHPC_A04_051/alexfil/MSA-Datasets/CMU-MOSEI/Processed/unaligned_50.pkl', 'seq_lens': [50, 500, 375], 'feature_dims': [768, 74, 35], 'train_samples': 16326, 'num_classes': 3, 'language': 'en', 'KeyEval': 'Loss', 'missing_rate': [0.0, 0.0, 0.0], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'early_stop': 10, 'use_bert': False, 'use_bert_finetune': False, 'attn_mask': True, 'excludeZero': True, 'update_epochs': 8, 'use_augmentation': False, 'use_m3xup': False, 'hfPath': False, 'use_ulgm': False, 'update_labels_patience': 1, 'H': 3.0, 'del_model': True, 'max_token_len': 50, 'pad_token': '<|endoftext|>', 'lm': '/leonardo_work/EUHPC_A04_051/alexfil/gpt2-large', 'use_bf16': False, 'task_out': 1, 'use_clm': True, 'gamma': 1.0, 'l_bn': 1.0, 'l_av': 1.0, 'l_t': 1.0, 'warmup_epochs': 1, 'max_epochs': 20, 'beta_1': 0.9, 'beta_2': 0.95, 'use_lnorm': True, 'rescale': False, 'rescaler': 'sqrt', 'use_seqaug': True, 'n_bn_fusion': 12, 'modded_loss': True, 'embedding_attr_name': 'transformer.wte', 'decoder_layers_attr_name': 'transformer.h', 'mmgpt': {'type': 'gpt2', 'd_out': 64, 'combine': True, 'dropout': 0.1, 'mm_layer': [7, 14, 21, 28, 35], 'top_k': 3, 'layer_dropout': 0.0, 'dense': True, 'tie_ffn': True, 'n_embd': 1280, 'bias': True, 'kv_dim': 30, 'n_head': 16, 'd_mm': 1280, 'gating': 'sigmoid', 'init_gate': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'use_softperm': True, 'p_perm': 0.3, 'p_apply': 0.25, 'use_lora': False, 'lora': {'lora_alpha': 128, 'r': 64, 'lora_dropout': 0.05}}, 'av_enc': {'finetune': True, 'from_pretrained': True, 'path_to_pretrained': '/leonardo_work/EUHPC_A04_051/alexfil/DeepMLF-Reprod/checkpoints/bienc-mosei-1990/bienc-mosei-1990.pth', 'feature_dims': [768, 74, 35], 'd_enc': 30, 'n_embd': 30, 'n_head': 6, 'nlevels': 3, 'd_enc_out': 30, 'maxlen': 50, 'p_mask': 0.15, 'enc_attn_dropout': 0.1, 'enc_res_dropout': 0.1, 'enc_dropout': 0.1, 'use_softperm': True, 'p_perm': 0.2, 'mask_perm_ratio': 0.5, 'tf_fusion': False, 'use_bn': False, 'use_ln': False}, 'gpt': {'vocab_size': 50257, 'block_size': 1024, 'bias': True, 'n_embd': 1024, 'n_layer': 24, 'n_head': 16, 'dropout': 0.0}, 'batch_size': 32, 'grad_clip': 5.0, 'patience': 10, 'weight_decay_mmgpt': 0.1, 'weight_decay_av': 0.1, 'learning_rate_av': 0.0001, 'learning_rate_mmgpt': 0.0001, 'device': device(type='cuda', index=0), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': '', 'feature_A': '', 'feature_V': ''}
2026-01-18 15:52:38,651 - MMSA [INFO] - Seeds: [1994]
2026-01-18 15:52:38,651 - MMSA [INFO] - ------------------------------ Running with seed 1994 [1/1] ------------------------------
2026-01-18 16:04:06,981 - MMSA [INFO] - The model has 914780556 trainable parameters
2026-01-18 16:08:44,885 - MMSA [INFO] - TRAIN-(msalm) [1/1/1] >> loss: 0.8128  Has0_acc_2: 0.6178  Has0_F1_score: 0.6352  Non0_acc_2: 0.6405  Non0_F1_score: 0.6463  Mult_acc_5: 0.4083  Mult_acc_7: 0.4068  MAE: 0.8131  Corr: 0.3661  clm loss: 4.2401 total loss: 7.6184 bn loss: 0.8626 av loss: 0.8367 text loss: 0.8661
2026-01-18 16:08:53,898 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7584  Has0_F1_score: 0.7689  Non0_acc_2: 0.8018  Non0_F1_score: 0.8032  Mult_acc_5: 0.4714  Mult_acc_7: 0.4586  MAE: 0.6376  Corr: 0.6230  Loss: 0.6369 
2026-01-18 16:13:36,382 - MMSA [INFO] - TRAIN-(msalm) [1/2/1] >> loss: 0.6041  Has0_acc_2: 0.7736  Has0_F1_score: 0.7818  Non0_acc_2: 0.8192  Non0_F1_score: 0.8202  Mult_acc_5: 0.5124  Mult_acc_7: 0.4985  MAE: 0.6042  Corr: 0.7030  clm loss: 3.7692 total loss: 6.4922 bn loss: 0.63 av loss: 0.804 text loss: 0.6849
2026-01-18 16:13:45,108 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8006  Has0_F1_score: 0.8094  Non0_acc_2: 0.8512  Non0_F1_score: 0.8526  Mult_acc_5: 0.5601  Mult_acc_7: 0.5473  MAE: 0.5245  Corr: 0.7442  Loss: 0.5227 
2026-01-18 16:18:29,067 - MMSA [INFO] - TRAIN-(msalm) [1/3/1] >> loss: 0.5361  Has0_acc_2: 0.8147  Has0_F1_score: 0.8199  Non0_acc_2: 0.8584  Non0_F1_score: 0.8582  Mult_acc_5: 0.5557  Mult_acc_7: 0.5362  MAE: 0.5352  Corr: 0.7731  clm loss: 3.6156 total loss: 6.0769 bn loss: 0.5358 av loss: 0.7993 text loss: 0.5902
2026-01-18 16:18:38,050 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8429  Has0_F1_score: 0.8465  Non0_acc_2: 0.8720  Non0_F1_score: 0.8714  Mult_acc_5: 0.5788  Mult_acc_7: 0.5644  MAE: 0.5000  Corr: 0.7692  Loss: 0.5001 
2026-01-18 16:23:21,767 - MMSA [INFO] - TRAIN-(msalm) [1/4/1] >> loss: 0.5002  Has0_acc_2: 0.8261  Has0_F1_score: 0.8309  Non0_acc_2: 0.8735  Non0_F1_score: 0.8732  Mult_acc_5: 0.5918  Mult_acc_7: 0.5694  MAE: 0.4999  Corr: 0.8020  clm loss: 3.5442 total loss: 5.8872 bn loss: 0.5016 av loss: 0.7958 text loss: 0.5454
2026-01-18 16:23:30,590 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8381  Has0_F1_score: 0.8418  Non0_acc_2: 0.8665  Non0_F1_score: 0.8657  Mult_acc_5: 0.5724  Mult_acc_7: 0.5585  MAE: 0.4904  Corr: 0.7750  Loss: 0.4893 
2026-01-18 16:28:12,366 - MMSA [INFO] - TRAIN-(msalm) [1/5/1] >> loss: 0.4701  Has0_acc_2: 0.8320  Has0_F1_score: 0.8371  Non0_acc_2: 0.8869  Non0_F1_score: 0.8868  Mult_acc_5: 0.6098  Mult_acc_7: 0.5859  MAE: 0.4704  Corr: 0.8251  clm loss: 3.4836 total loss: 5.7177 bn loss: 0.472 av loss: 0.7931 text loss: 0.4989
2026-01-18 16:28:21,069 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8466  Has0_F1_score: 0.8502  Non0_acc_2: 0.8762  Non0_F1_score: 0.8756  Mult_acc_5: 0.5810  Mult_acc_7: 0.5649  MAE: 0.4930  Corr: 0.7750  Loss: 0.4935 
2026-01-18 16:32:59,217 - MMSA [INFO] - TRAIN-(msalm) [2/6/1] >> loss: 0.4455  Has0_acc_2: 0.8420  Has0_F1_score: 0.8463  Non0_acc_2: 0.8956  Non0_F1_score: 0.8953  Mult_acc_5: 0.6286  Mult_acc_7: 0.6055  MAE: 0.4452  Corr: 0.8419  clm loss: 3.4443 total loss: 5.6002 bn loss: 0.4521 av loss: 0.7916 text loss: 0.4668
2026-01-18 16:33:08,342 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8247  Has0_F1_score: 0.8307  Non0_acc_2: 0.8630  Non0_F1_score: 0.8634  Mult_acc_5: 0.5740  Mult_acc_7: 0.5596  MAE: 0.4939  Corr: 0.7769  Loss: 0.4943 
2026-01-18 16:37:48,099 - MMSA [INFO] - TRAIN-(msalm) [3/7/1] >> loss: 0.4237  Has0_acc_2: 0.8418  Has0_F1_score: 0.8467  Non0_acc_2: 0.9027  Non0_F1_score: 0.9027  Mult_acc_5: 0.6537  Mult_acc_7: 0.6292  MAE: 0.4235  Corr: 0.8579  clm loss: 3.4131 total loss: 5.4942 bn loss: 0.4296 av loss: 0.7911 text loss: 0.4368
2026-01-18 16:37:57,214 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8407  Has0_F1_score: 0.8442  Non0_acc_2: 0.8693  Non0_F1_score: 0.8684  Mult_acc_5: 0.5719  Mult_acc_7: 0.5569  MAE: 0.5014  Corr: 0.7754  Loss: 0.5004 
2026-01-18 16:42:36,799 - MMSA [INFO] - TRAIN-(msalm) [4/8/1] >> loss: 0.3993  Has0_acc_2: 0.8543  Has0_F1_score: 0.8583  Non0_acc_2: 0.9122  Non0_F1_score: 0.9119  Mult_acc_5: 0.6680  Mult_acc_7: 0.6441  MAE: 0.3990  Corr: 0.8738  clm loss: 3.3743 total loss: 5.3722 bn loss: 0.4031 av loss: 0.7899 text loss: 0.4056
2026-01-18 16:42:46,023 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8509  Has0_F1_score: 0.8508  Non0_acc_2: 0.8623  Non0_F1_score: 0.8591  Mult_acc_5: 0.5762  Mult_acc_7: 0.5596  MAE: 0.5160  Corr: 0.7721  Loss: 0.5163 
2026-01-18 16:47:26,315 - MMSA [INFO] - TRAIN-(msalm) [5/9/1] >> loss: 0.3813  Has0_acc_2: 0.8569  Has0_F1_score: 0.8612  Non0_acc_2: 0.9208  Non0_F1_score: 0.9207  Mult_acc_5: 0.6891  Mult_acc_7: 0.6629  MAE: 0.3814  Corr: 0.8843  clm loss: 3.3633 total loss: 5.313 bn loss: 0.3913 av loss: 0.7895 text loss: 0.3877
2026-01-18 16:47:35,843 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8295  Has0_F1_score: 0.8345  Non0_acc_2: 0.8665  Non0_F1_score: 0.8661  Mult_acc_5: 0.5703  Mult_acc_7: 0.5521  MAE: 0.5087  Corr: 0.7706  Loss: 0.5084 
2026-01-18 16:52:15,933 - MMSA [INFO] - TRAIN-(msalm) [6/10/1] >> loss: 0.3637  Has0_acc_2: 0.8605  Has0_F1_score: 0.8647  Non0_acc_2: 0.9271  Non0_F1_score: 0.9270  Mult_acc_5: 0.7012  Mult_acc_7: 0.6773  MAE: 0.3634  Corr: 0.8951  clm loss: 3.3417 total loss: 5.2368 bn loss: 0.3753 av loss: 0.7879 text loss: 0.3682
2026-01-18 16:52:24,740 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7777  Has0_F1_score: 0.7889  Non0_acc_2: 0.8401  Non0_F1_score: 0.8425  Mult_acc_5: 0.5735  Mult_acc_7: 0.5591  MAE: 0.5074  Corr: 0.7751  Loss: 0.5071 
2026-01-18 16:57:02,035 - MMSA [INFO] - TRAIN-(msalm) [7/11/1] >> loss: 0.3434  Has0_acc_2: 0.8629  Has0_F1_score: 0.8673  Non0_acc_2: 0.9363  Non0_F1_score: 0.9363  Mult_acc_5: 0.7186  Mult_acc_7: 0.6957  MAE: 0.3433  Corr: 0.9054  clm loss: 3.3119 total loss: 5.1496 bn loss: 0.3584 av loss: 0.7874 text loss: 0.3486
2026-01-18 16:57:10,711 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8284  Has0_F1_score: 0.8331  Non0_acc_2: 0.8616  Non0_F1_score: 0.8611  Mult_acc_5: 0.5756  Mult_acc_7: 0.5591  MAE: 0.5038  Corr: 0.7718  Loss: 0.5044 
2026-01-18 17:01:46,536 - MMSA [INFO] - TRAIN-(msalm) [8/12/1] >> loss: 0.3298  Has0_acc_2: 0.8662  Has0_F1_score: 0.8706  Non0_acc_2: 0.9426  Non0_F1_score: 0.9426  Mult_acc_5: 0.7296  Mult_acc_7: 0.7054  MAE: 0.3297  Corr: 0.9116  clm loss: 3.3036 total loss: 5.0964 bn loss: 0.3444 av loss: 0.7876 text loss: 0.3311
2026-01-18 17:01:55,203 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.7958  Has0_F1_score: 0.8055  Non0_acc_2: 0.8484  Non0_F1_score: 0.8504  Mult_acc_5: 0.5649  Mult_acc_7: 0.5500  MAE: 0.5091  Corr: 0.7709  Loss: 0.5097 
2026-01-18 17:06:31,274 - MMSA [INFO] - TRAIN-(msalm) [9/13/1] >> loss: 0.3226  Has0_acc_2: 0.8652  Has0_F1_score: 0.8696  Non0_acc_2: 0.9422  Non0_F1_score: 0.9422  Mult_acc_5: 0.7387  Mult_acc_7: 0.7122  MAE: 0.3223  Corr: 0.9188  clm loss: 3.2925 total loss: 5.0521 bn loss: 0.3326 av loss: 0.7871 text loss: 0.3173
2026-01-18 17:06:40,071 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8108  Has0_F1_score: 0.8186  Non0_acc_2: 0.8540  Non0_F1_score: 0.8552  Mult_acc_5: 0.5697  Mult_acc_7: 0.5553  MAE: 0.5032  Corr: 0.7708  Loss: 0.5039 
2026-01-18 17:11:15,965 - MMSA [INFO] - TRAIN-(msalm) [10/14/1] >> loss: 0.3135  Has0_acc_2: 0.8711  Has0_F1_score: 0.8753  Non0_acc_2: 0.9498  Non0_F1_score: 0.9498  Mult_acc_5: 0.7456  Mult_acc_7: 0.7204  MAE: 0.3135  Corr: 0.9228  clm loss: 3.2743 total loss: 5.0007 bn loss: 0.3218 av loss: 0.7864 text loss: 0.3047
2026-01-18 17:11:24,616 - MMSA [INFO] - VAL-(msalm) >>  Has0_acc_2: 0.8124  Has0_F1_score: 0.8194  Non0_acc_2: 0.8547  Non0_F1_score: 0.8553  Mult_acc_5: 0.5756  Mult_acc_7: 0.5596  MAE: 0.5020  Corr: 0.7708  Loss: 0.5041 
2026-01-18 17:11:47,846 - MMSA [INFO] - TEST-(msalm) >>  Has0_acc_2: 0.8358  Has0_F1_score: 0.8398  Non0_acc_2: 0.8726  Non0_F1_score: 0.8723  Mult_acc_5: 0.5733  Mult_acc_7: 0.5548  MAE: 0.5042  Corr: 0.7998  Loss: 0.5048 
2026-01-18 17:11:50,100 - MMSA [INFO] - Result for seed 1994: {'Has0_acc_2': 0.8358, 'Has0_F1_score': 0.8398, 'Non0_acc_2': 0.8726, 'Non0_F1_score': 0.8723, 'Mult_acc_5': 0.5733, 'Mult_acc_7': 0.5548, 'MAE': 0.5042, 'Corr': 0.7998, 'Loss': 0.5048, 'seed': 1994}
2026-01-18 17:11:50,135 - MMSA [INFO] - Results saved to MMSA/results/mosei/nf12_k3_0001-exp-track/thesis-mosei-nf12-k3-01-exp-track/normal/mosei_avg.csv.
