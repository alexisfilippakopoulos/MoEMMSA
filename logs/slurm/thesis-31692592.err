MMSA - ======================================== Program Start ========================================
MMSA - Running with args:
MMSA - {'model_name': 'msalm', 'dataset_name': 'sims', 'featurePath': '/leonardo_work/EUHPC_A04_051/alexfil/MSA-Datasets/CH-SIMS/unaligned_39.pkl', 'seq_lens': [39, 400, 55], 'feature_dims': [768, 33, 709], 'train_samples': 1368, 'num_classes': 3, 'language': 'cn', 'KeyEval': 'Loss', 'missing_rate': [0.0, 0.0, 0.0], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'early_stop': 10, 'use_bert': False, 'use_bert_finetune': False, 'attn_mask': True, 'excludeZero': True, 'update_epochs': 8, 'use_augmentation': False, 'use_m3xup': False, 'hfPath': False, 'use_ulgm': False, 'update_labels_patience': 1, 'H': 3.0, 'del_model': True, 'max_token_len': 39, 'pad_token': '<|endoftext|>', 'lm': '/leonardo_work/EUHPC_A04_051/alexfil/gpt2-chinese-cluecorpussmall', 'use_bf16': False, 'task_out': 1, 'use_clm': True, 'gamma': 1.0, 'l_bn': 1.0, 'l_av': 1.0, 'l_t': 1.0, 'warmup_epochs': 1, 'max_epochs': 100, 'beta_1': 0.9, 'beta_2': 0.95, 'use_lnorm': True, 'rescale': False, 'rescaler': 'sqrt', 'use_seqaug': True, 'n_bn_fusion': 24, 'modded_loss': True, 'embedding_attr_name': 'transformer.wte', 'decoder_layers_attr_name': 'transformer.h', 'mmgpt': {'type': 'gpt2', 'd_out': 64, 'combine': True, 'dropout': 0.1, 'mm_layer': [5, 6, 7, 8, 9, 10, 11], 'top_k': 2, 'layer_dropout': 0.0, 'dense': True, 'tie_ffn': True, 'n_embd': 768, 'bias': True, 'kv_dim': 30, 'n_head': 16, 'd_mm': 768, 'gating': 'sigmoid', 'init_gate': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'use_softperm': True, 'p_perm': 0.3, 'p_apply': 0.25, 'use_lora': False, 'lora': {'lora_alpha': 128, 'r': 64, 'lora_dropout': 0.05}}, 'av_enc': {'finetune': True, 'from_pretrained': True, 'path_to_pretrained': '/leonardo_work/EUHPC_A04_051/alexfil/DeepMLF-Reprod/checkpoints/bienc-sims-1990/bienc-sims-1990.pth', 'feature_dims': [768, 33, 709], 'd_enc': 30, 'n_embd': 30, 'n_head': 6, 'nlevels': 3, 'd_enc_out': 30, 'maxlen': 55, 'p_mask': 0.15, 'enc_attn_dropout': 0.1, 'enc_res_dropout': 0.1, 'enc_dropout': 0.1, 'use_softperm': True, 'p_perm': 0.2, 'mask_perm_ratio': 0.5, 'tf_fusion': False, 'use_bn': True, 'use_ln': False}, 'gpt': {'vocab_size': 50257, 'block_size': 1024, 'bias': True, 'n_embd': 1024, 'n_layer': 24, 'n_head': 16, 'dropout': 0.0}, 'batch_size': 32, 'grad_clip': 5.0, 'patience': 10, 'weight_decay_mmgpt': 0.1, 'weight_decay_av': 0.1, 'learning_rate_av': 0.0001, 'learning_rate_mmgpt': 0.0001, 'device': device(type='cuda', index=0), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': '', 'feature_A': '', 'feature_V': ''}
MMSA - Seeds: [1990, 1991, 1992, 1993, 1994]
MMSA - ------------------------------ Running with seed 1990 [1/5] ------------------------------
Map:   0%|          | 0/1368 [00:00<?, ? examples/s]Map:  24%|██▎       | 323/1368 [00:00<00:00, 3184.44 examples/s]Map:  52%|█████▏    | 705/1368 [00:00<00:00, 3550.68 examples/s]Map:  86%|████████▌ | 1177/1368 [00:01<00:00, 921.02 examples/s]                                                                Map (num_proc=8):   0%|          | 0/1368 [00:00<?, ? examples/s]Map (num_proc=8):  12%|█▎        | 171/1368 [00:05<00:41, 28.85 examples/s]Map (num_proc=8):  25%|██▌       | 342/1368 [00:06<00:18, 56.49 examples/s]Map (num_proc=8):  38%|███▊      | 513/1368 [00:08<00:10, 79.27 examples/s]Map (num_proc=8):  50%|█████     | 684/1368 [00:09<00:06, 100.16 examples/s]Map (num_proc=8):  62%|██████▎   | 855/1368 [00:10<00:04, 118.62 examples/s]Map (num_proc=8):  75%|███████▌  | 1026/1368 [00:11<00:03, 111.26 examples/s]Map (num_proc=8):  88%|████████▊ | 1197/1368 [00:11<00:01, 159.91 examples/s]Map (num_proc=8): 100%|██████████| 1368/1368 [00:12<00:00, 183.47 examples/s]                                                                             Map:   0%|          | 0/1368 [00:00<?, ? examples/s]Map:   2%|▏         | 32/1368 [00:00<00:04, 308.08 examples/s]Map:   5%|▍         | 64/1368 [00:00<00:04, 310.51 examples/s]Map:   7%|▋         | 96/1368 [00:00<00:04, 312.00 examples/s]Map:   9%|▉         | 128/1368 [00:00<00:03, 312.67 examples/s]Map:  12%|█▏        | 160/1368 [00:00<00:03, 312.64 examples/s]Map:  14%|█▍        | 192/1368 [00:00<00:03, 312.86 examples/s]Map:  16%|█▋        | 224/1368 [00:00<00:03, 312.96 examples/s]Map:  19%|█▊        | 256/1368 [00:00<00:03, 313.03 examples/s]Map:  21%|██        | 288/1368 [00:00<00:03, 312.84 examples/s]Map:  23%|██▎       | 320/1368 [00:01<00:03, 312.74 examples/s]Map:  26%|██▌       | 352/1368 [00:01<00:03, 312.63 examples/s]Map:  28%|██▊       | 384/1368 [00:01<00:03, 312.38 examples/s]Map:  30%|███       | 416/1368 [00:01<00:03, 312.59 examples/s]Map:  33%|███▎      | 448/1368 [00:01<00:02, 312.56 examples/s]Map:  35%|███▌      | 480/1368 [00:01<00:02, 312.20 examples/s]Map:  37%|███▋      | 512/1368 [00:01<00:02, 311.97 examples/s]Map:  40%|███▉      | 544/1368 [00:01<00:02, 311.90 examples/s]Map:  42%|████▏     | 576/1368 [00:01<00:02, 311.96 examples/s]Map:  44%|████▍     | 608/1368 [00:01<00:02, 311.69 examples/s]Map:  47%|████▋     | 640/1368 [00:02<00:02, 311.76 examples/s]Map:  49%|████▉     | 672/1368 [00:02<00:02, 311.53 examples/s]Map:  51%|█████▏    | 704/1368 [00:02<00:02, 311.42 examples/s]Map:  54%|█████▍    | 736/1368 [00:02<00:02, 311.14 examples/s]Map:  56%|█████▌    | 768/1368 [00:02<00:01, 311.15 examples/s]Map:  58%|█████▊    | 800/1368 [00:02<00:01, 311.20 examples/s]Map:  61%|██████    | 832/1368 [00:02<00:01, 311.22 examples/s]Map:  63%|██████▎   | 864/1368 [00:02<00:01, 311.28 examples/s]Map:  65%|██████▌   | 896/1368 [00:02<00:01, 310.95 examples/s]Map:  68%|██████▊   | 928/1368 [00:02<00:01, 310.37 examples/s]Map:  70%|███████   | 960/1368 [00:03<00:01, 310.17 examples/s]Map:  73%|███████▎  | 992/1368 [00:03<00:01, 309.73 examples/s]Map:  76%|███████▌  | 1033/1368 [00:05<00:07, 42.29 examples/s]Map:  78%|███████▊  | 1067/1368 [00:05<00:05, 56.90 examples/s]Map:  80%|████████  | 1101/1368 [00:05<00:03, 75.32 examples/s]Map:  83%|████████▎ | 1135/1368 [00:05<00:02, 97.61 examples/s]Map:  85%|████████▌ | 1169/1368 [00:06<00:01, 123.28 examples/s]Map:  88%|████████▊ | 1203/1368 [00:06<00:01, 151.19 examples/s]Map:  90%|█████████ | 1237/1368 [00:06<00:00, 179.65 examples/s]Map:  93%|█████████▎| 1270/1368 [00:06<00:00, 206.17 examples/s]Map:  95%|█████████▌| 1303/1368 [00:06<00:00, 230.32 examples/s]Map:  98%|█████████▊| 1336/1368 [00:06<00:00, 251.10 examples/s]Map: 100%|██████████| 1368/1368 [00:07<00:00, 91.26 examples/s]                                                                Map:   0%|          | 0/1368 [00:00<?, ? examples/s]Map:   2%|▏         | 32/1368 [00:00<00:04, 309.60 examples/s]Map:   5%|▍         | 64/1368 [00:00<00:04, 312.73 examples/s]Map:   7%|▋         | 96/1368 [00:00<00:04, 314.35 examples/s]Map:   9%|▉         | 128/1368 [00:00<00:03, 315.06 examples/s]Map:  12%|█▏        | 160/1368 [00:00<00:03, 314.92 examples/s]Map:  14%|█▍        | 192/1368 [00:00<00:03, 315.16 examples/s]Map:  16%|█▋        | 224/1368 [00:00<00:03, 315.46 examples/s]Map:  19%|█▊        | 256/1368 [00:00<00:03, 315.50 examples/s]Map:  21%|██        | 288/1368 [00:00<00:03, 315.82 examples/s]Map:  23%|██▎       | 320/1368 [00:01<00:03, 315.87 examples/s]Map:  26%|██▌       | 352/1368 [00:01<00:03, 315.92 examples/s]Map:  28%|██▊       | 384/1368 [00:01<00:03, 316.09 examples/s]Map:  30%|███       | 416/1368 [00:01<00:03, 316.07 examples/s]Map:  33%|███▎      | 448/1368 [00:01<00:02, 315.96 examples/s]Map:  35%|███▌      | 480/1368 [00:01<00:02, 315.93 examples/s]Map:  37%|███▋      | 512/1368 [00:01<00:02, 315.73 examples/s]Map:  40%|███▉      | 544/1368 [00:01<00:02, 315.69 examples/s]Map:  42%|████▏     | 576/1368 [00:01<00:02, 315.86 examples/s]Map:  44%|████▍     | 608/1368 [00:01<00:02, 315.61 examples/s]Map:  47%|████▋     | 640/1368 [00:02<00:02, 315.50 examples/s]Map:  49%|████▉     | 672/1368 [00:02<00:02, 315.43 examples/s]Map:  51%|█████▏    | 704/1368 [00:02<00:02, 315.36 examples/s]Map:  54%|█████▍    | 736/1368 [00:02<00:02, 315.15 examples/s]Map:  56%|█████▌    | 768/1368 [00:02<00:01, 315.23 examples/s]Map:  58%|█████▊    | 800/1368 [00:02<00:01, 315.24 examples/s]Map:  61%|██████    | 832/1368 [00:02<00:01, 315.63 examples/s]Map:  63%|██████▎   | 864/1368 [00:02<00:01, 315.44 examples/s]Map:  65%|██████▌   | 896/1368 [00:02<00:01, 315.27 examples/s]Map:  68%|██████▊   | 928/1368 [00:02<00:01, 314.57 examples/s]Map:  70%|███████   | 960/1368 [00:03<00:01, 313.98 examples/s]Map:  73%|███████▎  | 992/1368 [00:03<00:01, 313.46 examples/s]Map:  75%|███████▌  | 1032/1368 [00:05<00:07, 42.26 examples/s]Map:  78%|███████▊  | 1064/1368 [00:05<00:05, 56.09 examples/s]Map:  80%|████████  | 1096/1368 [00:05<00:03, 73.58 examples/s]Map:  82%|████████▏ | 1128/1368 [00:05<00:02, 94.84 examples/s]Map:  85%|████████▍ | 1160/1368 [00:06<00:01, 119.43 examples/s]Map:  87%|████████▋ | 1192/1368 [00:06<00:01, 146.36 examples/s]Map:  89%|████████▉ | 1224/1368 [00:06<00:00, 173.97 examples/s]Map:  92%|█████████▏| 1256/1368 [00:06<00:00, 200.66 examples/s]Map:  94%|█████████▍| 1288/1368 [00:06<00:00, 224.76 examples/s]Map:  96%|█████████▋| 1320/1368 [00:06<00:00, 245.42 examples/s]Map:  99%|█████████▉| 1352/1368 [00:06<00:00, 262.12 examples/s]                                                                Map:   0%|          | 0/1368 [00:00<?, ? examples/s]Map:   2%|▏         | 32/1368 [00:00<00:04, 310.83 examples/s]Map:   5%|▍         | 64/1368 [00:00<00:04, 315.42 examples/s]Map:   7%|▋         | 96/1368 [00:00<00:04, 316.76 examples/s]Map:   9%|▉         | 128/1368 [00:00<00:03, 317.51 examples/s]Map:  12%|█▏        | 160/1368 [00:00<00:03, 317.86 examples/s]Map:  14%|█▍        | 192/1368 [00:00<00:03, 318.12 examples/s]Map:  16%|█▋        | 224/1368 [00:00<00:03, 318.33 examples/s]Map:  19%|█▊        | 256/1368 [00:00<00:03, 318.52 examples/s]Map:  21%|██        | 288/1368 [00:00<00:03, 318.73 examples/s]Map:  23%|██▎       | 320/1368 [00:01<00:03, 318.62 examples/s]Map:  26%|██▌       | 352/1368 [00:01<00:03, 318.70 examples/s]Map:  28%|██▊       | 384/1368 [00:01<00:03, 318.66 examples/s]Map:  30%|███       | 416/1368 [00:01<00:02, 318.38 examples/s]Map:  33%|███▎      | 448/1368 [00:01<00:02, 318.44 examples/s]Map:  35%|███▌      | 480/1368 [00:01<00:02, 318.56 examples/s]Map:  37%|███▋      | 512/1368 [00:01<00:02, 318.52 examples/s]Map:  40%|███▉      | 544/1368 [00:01<00:02, 318.42 examples/s]Map:  42%|████▏     | 576/1368 [00:01<00:02, 318.53 examples/s]Map:  45%|████▍     | 609/1368 [00:01<00:02, 318.64 examples/s]Map:  47%|████▋     | 641/1368 [00:02<00:02, 318.49 examples/s]Map:  49%|████▉     | 673/1368 [00:02<00:02, 318.48 examples/s]Map:  52%|█████▏    | 705/1368 [00:02<00:02, 318.45 examples/s]Map:  54%|█████▍    | 737/1368 [00:02<00:01, 318.58 examples/s]Map:  56%|█████▌    | 769/1368 [00:02<00:01, 318.50 examples/s]Map:  59%|█████▊    | 801/1368 [00:02<00:01, 318.45 examples/s]Map:  61%|██████    | 833/1368 [00:02<00:01, 318.38 examples/s]Map:  63%|██████▎   | 865/1368 [00:02<00:01, 318.45 examples/s]Map:  66%|██████▌   | 897/1368 [00:02<00:01, 318.50 examples/s]Map:  68%|██████▊   | 929/1368 [00:02<00:01, 318.52 examples/s]Map:  70%|███████   | 961/1368 [00:03<00:01, 318.36 examples/s]Map:  73%|███████▎  | 993/1368 [00:03<00:01, 318.36 examples/s]Map:  75%|███████▍  | 1025/1368 [00:03<00:01, 318.42 examples/s]Map:  77%|███████▋  | 1057/1368 [00:03<00:00, 318.56 examples/s]Map:  80%|███████▉  | 1089/1368 [00:03<00:00, 318.37 examples/s]Map:  82%|████████▏ | 1121/1368 [00:03<00:00, 318.50 examples/s]Map:  84%|████████▍ | 1153/1368 [00:03<00:00, 318.53 examples/s]Map:  87%|████████▋ | 1185/1368 [00:03<00:00, 318.65 examples/s]Map:  89%|████████▉ | 1217/1368 [00:03<00:00, 318.76 examples/s]Map:  91%|█████████▏| 1249/1368 [00:03<00:00, 318.72 examples/s]Map:  94%|█████████▎| 1281/1368 [00:04<00:00, 318.58 examples/s]Map:  96%|█████████▌| 1313/1368 [00:04<00:00, 318.56 examples/s]Map:  98%|█████████▊| 1345/1368 [00:04<00:00, 318.21 examples/s]                                                                Saving the dataset (0/2 shards):   0%|          | 0/1368 [00:00<?, ? examples/s]Saving the dataset (0/2 shards):  50%|█████     | 684/1368 [00:00<00:00, 1693.76 examples/s]Saving the dataset (1/2 shards):  50%|█████     | 684/1368 [00:00<00:00, 1693.76 examples/s]Saving the dataset (1/2 shards): 100%|██████████| 1368/1368 [00:00<00:00, 1791.52 examples/s]Saving the dataset (2/2 shards): 100%|██████████| 1368/1368 [00:00<00:00, 1791.52 examples/s]                                                                                             Map:   0%|          | 0/456 [00:00<?, ? examples/s]Map:  85%|████████▍ | 387/456 [00:00<00:00, 3794.00 examples/s]                                                               Map (num_proc=8):   0%|          | 0/456 [00:00<?, ? examples/s]Map (num_proc=8):  12%|█▎        | 57/456 [00:02<00:15, 26.12 examples/s]Map (num_proc=8):  25%|██▌       | 114/456 [00:02<00:07, 47.45 examples/s]Map (num_proc=8):  38%|███▊      | 171/456 [00:03<00:04, 64.76 examples/s]Map (num_proc=8):  50%|█████     | 228/456 [00:03<00:02, 77.95 examples/s]Map (num_proc=8):  62%|██████▎   | 285/456 [00:04<00:01, 94.85 examples/s]Map (num_proc=8):  75%|███████▌  | 342/456 [00:04<00:01, 101.18 examples/s]Map (num_proc=8):  88%|████████▊ | 399/456 [00:05<00:00, 105.71 examples/s]Map (num_proc=8): 100%|██████████| 456/456 [00:05<00:00, 109.74 examples/s]                                                                           Map:   0%|          | 0/456 [00:00<?, ? examples/s]Map:   7%|▋         | 32/456 [00:00<00:01, 310.55 examples/s]Map:  14%|█▍        | 65/456 [00:00<00:01, 315.21 examples/s]Map:  21%|██▏       | 98/456 [00:00<00:01, 317.15 examples/s]Map:  29%|██▊       | 131/456 [00:00<00:01, 317.83 examples/s]Map:  36%|███▌      | 165/456 [00:00<00:00, 319.23 examples/s]Map:  43%|████▎     | 198/456 [00:00<00:00, 319.05 examples/s]Map:  50%|█████     | 230/456 [00:00<00:00, 318.29 examples/s]Map:  57%|█████▋    | 262/456 [00:00<00:00, 316.75 examples/s]Map:  64%|██████▍   | 294/456 [00:00<00:00, 316.37 examples/s]Map:  72%|███████▏  | 327/456 [00:01<00:00, 317.10 examples/s]Map:  79%|███████▊  | 359/456 [00:01<00:00, 317.43 examples/s]Map:  86%|████████▌ | 393/456 [00:01<00:00, 318.57 examples/s]Map:  94%|█████████▎| 427/456 [00:01<00:00, 319.55 examples/s]                                                              Map:   0%|          | 0/456 [00:00<?, ? examples/s]Map:   7%|▋         | 32/456 [00:00<00:01, 309.39 examples/s]Map:  14%|█▍        | 64/456 [00:00<00:01, 310.45 examples/s]Map:  21%|██        | 96/456 [00:00<00:01, 311.43 examples/s]slurmstepd: error: *** JOB 31692592 ON lrdn2500 CANCELLED AT 2025-12-29T20:28:02 ***
Map:  28%|██▊       | 128/456 [00:00<00:01, 312.00 examples/s]